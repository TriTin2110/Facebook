<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/SearchFriend.css" />
    <link rel="stylesheet" href="../css/responsive.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <title>BodyBook</title>
  </head>
  <body>
    <div class="app">
      <div class="nav">
        <div class="logo-search">
          <div class="logo">
            <a href="">B</a>
          </div>
          <div class="search">
            <input
              type="text"
              name="search"
              placeholder="Tìm kiếm trên BodyBook"
            />
            <div class="dropdown">
              <ul>
                <li>
                  <a href="../html/SearchFriend.html" class="dropdown-item"
                    >Dữ liệu 1</a
                  >
                </li>
                <li>
                  <a href="../html/SearchFriend.html" class="dropdown-item"
                    >Dữ liệu 2</a
                  >
                </li>
                <li>
                  <a href="../html/SearchFriend.html" class="dropdown-item"
                    >Dữ liệu 3</a
                  >
                </li>
              </ul>
            </div>
            <i class="fa-solid fa-arrow-left icon_left"></i>
            <i class="fa-solid fa-magnifying-glass icon_search"></i>
          </div>
        </div>
        <div class="nav-list">
          <ul>
            <li>
              <a href=""><i class="fa-solid fa-house"></i></a>
            </li>
            <li>
              <a href=""><i class="fa-solid fa-user-group"></i></a>
            </li>
            <li>
              <a href=""><i class="fa-solid fa-tv"></i></a>
            </li>
            <li>
              <a href=""><i class="fa-solid fa-shop"></i></a>
            </li>
            <li>
              <a href=""><i class="fa-solid fa-gamepad"></i></a>
            </li>
          </ul>
        </div>
        <div class="notify-mess">
          <ul class="nm_list">
            <li class="nm_item">
              <a href="#" class="nm_link"
                ><i class="nm_icon fa-solid fa-ellipsis"></i
              ></a>
            </li>
            <li class="nm_item">
              <a href="Messenger.jsp" class="nm_link"
                ><i class="nm_icon fa-solid fa-comments"></i
              ></a>
            </li>
            <li class="nm_item">
              <a href="#" class="nm_link"
                ><i class="nm_icon fa-solid fa-bell"></i
              ></a>
            </li>
            <li class="nm_item">
              <a href="#" class="nm_link">
                <img src="../img/avt.jpg" alt="" id="open-profile" />
                <div class="acc_more">
                  <ul>
                    <li>
                      <a href="../html/Profile.html">
                        <img src="../img/avt.jpg" alt="" />
                        <h3>Chí Nguyên</h3>
                      </a>
                    </li>
                    <li>
                      <a href="../html/infoChange.html">
                        <i class="fa-solid fa-gear"></i>
                        <h4>Cài đặt & quyền riêng tư</h4>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fa-solid fa-circle-question"></i>
                        <h4>Trợ giúp & hỗ trợ</h4>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fa-solid fa-moon"></i>
                        <h4>Màn hình & trợ năng</h4>
                      </a>
                    </li>
                    <li>
                      <a href="#">
                        <i class="fa-solid fa-exclamation"></i>
                        <h4>Đóng góp ý kiến</h4>
                      </a>
                    </li>
                    <li>
                      <a href="../html/LoginPage.jsp">
                        <i class="fa-solid fa-right-from-bracket"></i>
                        <h4>Đăng xuất</h4>
                      </a>
                    </li>
                  </ul>
                </div>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="body">
        <div class="section-left hide-on-mobile-tablet">
          <div class="left-top">
            <ul>
              <li>
                <h1>Kết quả tìm kiếm</h1>
              </li>
            </ul>
          </div>
          <div class="left-bot">
            <h4>Bộ lọc</h4>
            <ul>
              <li>
                <a href="#">
                  <i class="fa-regular fa-credit-card"></i>
                  <h5>Tất cả</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-regular fa-message"></i>
                  <h5>Bài viết</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-children"></i>
                  <h5>Mọi người</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-image"></i>
                  <h5>Ảnh</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-video"></i>
                  <h5>Video</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-shop"></i>
                  <h5>Marketplace</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-flag"></i>
                  <h5>Trang</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-location-dot"></i>
                  <h5>Địa điểm</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-children"></i>
                  <h5>Nhóm</h5>
                </a>
              </li>
              <li>
                <a href="#">
                  <i class="fa-solid fa-calendar-days"></i>
                  <h5>Sự kiện</h5>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="search-friend">
          <div class="search-friend_list">
            <ul>
              <li>
                <h2>Mọi người</h2>
              </li>
              <li>
                <div class="avt_name">
                  <img src="../img/friend1.jpg" alt="" />
                  <h3>Ngọc Thiến</h3>
                </div>
                <div class="addfr_btn">
                  <a href="#">Thêm bạn bè</a>
                </div>
              </li>
              <li>
                <div class="avt_name">
                  <img src="../img/friend1.jpg" alt="" />
                  <h3>Ngọc Thiến</h3>
                </div>
                <div class="addfr_btn">
                  <a href="#">Thêm bạn bè</a>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div class="section-right hide-on-mobile-tablet">
          <div class="advertise">
            <h4>Được tài trợ</h4>
            <ul>
              <li>
                <a href="#">
                  <img src="../img/anhqc.jpg" alt="" />
                  <div class="des">
                    <h5>Đặt Xe Ngay</h5>
                    <h6>xanhsm.com</h6>
                  </div>
                </a>
              </li>
              <li>
                <a href="#">
                  <img src="../img/anhqc2.jpg" alt="" />
                  <div class="des">
                    <h5>Đăng ký nhận ưu đãi</h5>
                    <h6>king52.fun</h6>
                  </div>
                </a>
              </li>
            </ul>
          </div>
          <div class="addfriend">
            <div class="header">
              <h4>Lời mời kết bạn</h4>
              <a href="#">Xem tất cả</a>
            </div>
            <div class="newfriend">
              <img src="../img/j97.jpg" alt="" class="nf-avt" />
              <div class="nf-information">
                <div class="name-acpt">
                  <h5>Anh Dắc 97</h5>
                  <a href="#">Xác nhận</a>
                </div>
                <div class="time-refuse">
                  <h6>32 phút</h6>
                  <a href="#">Xóa</a>
                </div>
              </div>
            </div>
          </div>
          <div class="friend">
            <h4>Người liên hệ</h4>
            <ul>
              <li>
                <img src="../img/friend1.jpg" alt="" />
                <span class="name-friend">Đặng Thiện</span>
              </li>
              <li>
                <img src="../img/friend2.jpg" alt="" />
                <span class="name-friend">Trí Tín</span>
              </li>
              <li>
                <img src="../img/friend3.jpg" alt="" />
                <span class="name-friend">Minh Triết</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script>
      // MỞ THÔNG TIN THÊM KHI NHẤN VÀO ẢNH AVT
      var open = document.getElementById("open-profile");
      var moreProfile = document.querySelector(".acc_more");
      open.onclick = function (e) {
        e.preventDefault();
        if (moreProfile.style.display == "none") {
          moreProfile.style.display = "block";
        } else {
          moreProfile.style.display = "none";
        }
      };
      // CHUYỂN ẢNH GIỮA CÁC STORY
      document.addEventListener("DOMContentLoaded", function () {
        const moveLeftButton = document.getElementById("moveLeftButton");
        const moveRightButton = document.getElementById("moveRightButton");
        const imageList = document.querySelector(".story");
        const images = document.querySelectorAll(".story img");
        const imageWidth = images[0].offsetWidth + 10; // Kích thước ảnh + margin
        let currentIndex = 0;

        moveLeftButton.addEventListener("click", function () {
          if (currentIndex > 0) {
            currentIndex--;
            imageList.style.transform = `translateX(-${
              currentIndex * imageWidth
            }px)`;
          }
        });

        moveRightButton.addEventListener("click", function () {
          if (currentIndex < images.length - 4) {
            // Số lượng ảnh hiển thị trong khung là 4
            currentIndex++;
            imageList.style.transform = `translateX(-${
              currentIndex * imageWidth
            }px)`;
          }
        });
      });
      // RÊ CHUỘT VÀO NÚT LIKE SẼ HIỂN THỊ THÊM CÁC CẢM XÚC KHÁC
      document.addEventListener("DOMContentLoaded", function () {
        const postContents = document.querySelectorAll(".post_content");
        postContents.forEach(function (postContent) {
          const likeButton = postContent.querySelector(".like-button");
          const iconLike = postContent.querySelector(".icon_like");
          const emotion = postContent.querySelector(".emotions");
          const emotionIcons = emotion.querySelectorAll(".emotion");
          const numberReact = postContent.querySelector(".number_react a span");
          let isBlue = false;
          let selectedEmotion = null;

          likeButton.addEventListener("click", function () {
            if (selectedEmotion) {
              // Nếu đã chọn cảm xúc khác, hủy bỏ cảm xúc đó
              selectedEmotion = null;
              iconLike.style.display = "inline-block";
              likeButton.innerHTML = "Thích";
              likeButton.style.color = "#65676b";
              iconLike.style.color = "#65676b";
              numberReact.innerText = parseInt(numberReact.innerText) - 1;
              isBlue = false;
            } else if (isBlue) {
              // Nếu đang thích, hủy thích
              // likeButton.innerHTML = '<i class="fa-solid fa-thumbs-up"></i> Thích';
              iconLike.style.display = "inline-block";
              likeButton.style.color = "#65676b";
              iconLike.style.color = "#65676b";
              numberReact.innerText = parseInt(numberReact.innerText) - 1;
              isBlue = false;
            } else {
              // Thích
              // likeButton.innerHTML = '<i class="fa-solid fa-thumbs-up"></i> Thích';
              // iconLike.style.display = 'inline-block';
              likeButton.style.color = "#0866ff";
              iconLike.style.color = "#0866ff";
              numberReact.innerText = parseInt(numberReact.innerText) + 1;
              isBlue = true;
            }
          });

          likeButton.addEventListener("mouseover", function () {
            emotion.style.display = "flex";
          });

          emotion.addEventListener("mouseover", function () {
            emotion.style.display = "flex";
          });

          likeButton.addEventListener("mouseout", function () {
            emotion.style.display = "none";
          });

          emotion.addEventListener("mouseout", function () {
            emotion.style.display = "none";
          });

          emotionIcons.forEach((emotionIcon) => {
            emotionIcon.addEventListener("click", function () {
              const getData = this.getAttribute("data-emotion");
              const getEmotionIcon = this.outerHTML;

              if (selectedEmotion) {
                // Nếu đã chọn cảm xúc khác, hủy bỏ cảm xúc đó
                selectedEmotion = null;
                numberReact.innerText = parseInt(numberReact.innerText) - 1;
              } else if (isBlue) {
                // Nếu đang thích, hủy thích
                isBlue = false;
                numberReact.innerText = parseInt(numberReact.innerText) - 1;
              }

              // Chọn cảm xúc mới
              likeButton.innerHTML = getEmotionIcon + " " + getData;
              numberReact.innerText = parseInt(numberReact.innerText) + 1;
              selectedEmotion = getData;
              iconLike.style.display = "none";
              emotion.style.display = "none";
            });
          });
        });
      });
      // ĐĂNG BÀI VIẾT
      document
        .getElementById("postButton")
        .addEventListener("click", function () {
          var content = document.getElementById("content_area").value;
          var fileInput = document.querySelector('input[type="file"]');
          var formData = new FormData();
          formData.append("content", content);
          formData.append("image", fileInput.files[0]);

          fetch("/SummerProject/post", {
            // Đường dẫn đầy đủ tới servlet
            method: "POST",
            body: formData,
          })
            .then((response) => response.json())
            .then((data) => {
              if (data && data.postContent && data.postImage) {
                var postHtml = `
                  <div class="post_content">
                      <div class="header_post">
                          <img src="../img/avt.jpg" alt="">
                          <div class="name-acc_post">
                              <h4>Chí Nguyên</h4>
                              <span>Just now</span>
                          </div>
                      </div>
                      <div class="caption_post">
                          <span>${data.postContent}</span>
                      </div>
                      <div class="content_post">
                          <img src="${data.postImage}" alt="">
                      </div>
                      <div class="interact_post">
                          <div class="number_react">
                              <i class="fa-solid fa-thumbs-up color_like"></i>
                              <i class="fa-solid fa-heart color_heart"></i>
                              <a href="#"> <span>0</span> </a>
                          </div>
                          <div class="cmt-share">
                              <a href="#">
                                  <span>0</span>
                                  <i class="fa-solid fa-comment color_cmt"></i>
                                  <span>0</span>
                                  <i class="fa-solid fa-share color_cmt"></i>
                              </a>
                          </div>
                      </div>
                      <div class="interact_btn">
                          <ul>
                              <li>
                                  <i class="fa-solid fa-thumbs-up"></i>
                                  <h4>Thích</h4>
                              </li>
                              <li>
                                  <i class="fa-solid fa-comment"></i>
                                  <h4>Bình luận</h4>
                              </li>
                              <li>
                                  <i class="fa-solid fa-paper-plane"></i>
                                  <h4>Gửi</h4>
                              </li>
                              <li>
                                  <i class="fa-solid fa-share"></i>
                                  <h4>Chia sẻ</h4>
                              </li>
                          </ul>
                      </div>
                  </div>
              `;

                var postContainer = document.querySelector(".post");
                postContainer.insertAdjacentHTML("afterbegin", postHtml);

                document.getElementById("content_area").value = "";
                fileInput.value = "";
                $("#myModal").modal("hide");
              } else {
                console.error("Invalid response data", data);
              }
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        });
    </script>
  </body>
</html>
